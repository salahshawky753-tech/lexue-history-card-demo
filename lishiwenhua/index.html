<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>乐学成长卡 - 历史文化篇</title>
<style>
    body {
        margin:0;
        font-family:"Microsoft YaHei",sans-serif;
        background:#f7f7f7;
    }
    header {
        background:#ffcc66;
        padding:10px;
        position:sticky;
        top:0;
        z-index:10;
        display:flex;
        align-items:center;
        justify-content:center;
        font-weight:bold;
        font-size:20px;
        color:#333;
    }
    section {
        padding:10px;
        max-width:800px;
        margin:0 auto;
    }
    .card {
        background:white;
        border-radius:12px;
        box-shadow:0 2px 6px rgba(0,0,0,0.1);
        padding:15px;
        margin-bottom:15px;
    }
    h2 {
        margin-top:0;
        color:#444;
    }
    .btn {
        background:#ff9933;
        color:white;
        border:none;
        border-radius:6px;
        padding:8px 12px;
        cursor:pointer;
        font-size:16px;
    }
    .btn:disabled {
        background:gray;
    }
    .quiz label {
        display:block;
        margin:6px 0;
    }
    .progress {
        height:20px;
        background:#eee;
        border-radius:10px;
        overflow:hidden;
    }
    .progress-bar {
        height:100%;
        background:#ff9933;
        text-align:center;
        color:white;
        line-height:20px;
        width:0;
    }
</style>
</head>
<body>

<header>乐学成长卡：历史文化篇</header>

<section>
    <!-- 知识阅读 -->
    <div class="card">
        <h2>知识阅读</h2>
        <p id="p1">泰州自古为水陆要冲，素有“汉唐名郡”之称。</p>
        <button class="btn" onclick="readText('p1')">🔊朗读</button>
        <p id="p2">古运河穿城而过，见证了数百年的商贸繁荣与文化交流。</p>
        <button class="btn" onclick="readText('p2')">🔊朗读</button>
    </div>

    <!-- 知识动画 -->
    <div class="card">
        <h2>动画展示</h2>
        <svg width="100%" height="120">
            <circle id="boat" cx="20" cy="60" r="20" fill="#B58900" onclick="clickBoat()" />
            抱歉，浏览器不支持SVG
        </svg>
        <p id="gameStatus">任务：点击小船 3 次（只能加分一次）</p>
        <button class="btn" onclick="resetGame()">重置小游戏</button>
    </div>

    <!-- 知识问答 -->
    <div class="card quiz">
        <h2>知识问答</h2>
        <div>
            <p>1. 泰州有“汉唐名郡”之称，对吗？</p>
            <label><input type="radio" name="q1" value="true">对</label>
            <label><input type="radio" name="q1" value="false">错</label>
        </div>
        <div>
            <p>2. 古运河是泰州历史和文化的重要见证，对吗？</p>
            <label><input type="radio" name="q2" value="true">对</label>
            <label><input type="radio" name="q2" value="false">错</label>
        </div>
        <button class="btn" onclick="checkQuiz()">提交答案</button>
        <p id="quizResult"></p>
    </div>

    <!-- 成长值 -->
    <div class="card">
        <h2>我的成长值</h2>
        <div class="progress">
            <div id="progressBar" class="progress-bar">0 / 10</div>
        </div>
    </div>
</section>

<script>
    // 配置
    const CONFIG = { maxPoints: 10, gamePoints: 4, quizPoints: 3 };
    let synth = window.speechSynthesis;
    let points = 0;
    let boatClicks = 0;
    let gameCompleted = false;
    let quizCompleted = false;

    // SVG小船动画
    let pos = 20;
    setInterval(() => {
        pos += 2;
        document.getElementById('boat').setAttribute('cx', pos % window.innerWidth);
    }, 50);

    // 点击小船
    function clickBoat(){
        if(gameCompleted) return;
        boatClicks++;
        document.getElementById('gameStatus').innerText = `已点击：${boatClicks} / 3`;
        if(boatClicks >= 3){
            gameCompleted = true;
            addPoints(CONFIG.gamePoints);
            document.getElementById('gameStatus').innerText += ` ✅ 完成游戏，+${CONFIG.gamePoints}分`;
        }
    }

    // 重置小游戏
    function resetGame(){
        boatClicks = 0;
        gameCompleted = false;
        document.getElementById('gameStatus').innerText = '任务：点击小船 3 次（只能加分一次）';
    }

    // 答题逻辑
    function checkQuiz(){
        if(quizCompleted) return;
        let score = 0;
        let q1 = document.querySelector('input[name="q1"]:checked');
        let q2 = document.querySelector('input[name="q2"]:checked');
        if(!q1 || !q2){ alert("请答完所有题目"); return; }
        if(q1.value === 'true') score += CONFIG.quizPoints;
        if(q2.value === 'true') score += CONFIG.quizPoints;
        addPoints(score);
        quizCompleted = true;
        document.getElementById('quizResult').innerText = `答题得分 ${score} 分`;
    }

    // 增加积分并更新进度
    function addPoints(score){
        points += score;
        if(points > CONFIG.maxPoints) points = CONFIG.maxPoints;
        let bar = document.getElementById('progressBar');
        bar.style.width = (points / CONFIG.maxPoints * 100) + '%';
        bar.innerText = `${points} / ${CONFIG.maxPoints}`;
    }

    // 语音朗读
    function readText(id){
        let text = document.getElementById(id).innerText;
        let utter = new SpeechSynthesisUtterance(text);
        utter.lang = 'zh-CN';
        synth.speak(utter);
    }
</script>
</body>
</html>
